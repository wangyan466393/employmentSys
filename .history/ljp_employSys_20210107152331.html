<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/ljp_employSys.css">
  <!-- 引入样式 -->
  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/element-ui/2.14.1/theme-chalk/index.css">
  <title>就业信息跟踪系统</title>
</head>

<body>
  <div class="header">
    <div class="logo"></div>
    <div class="login_name">
      <span class="avatar">
        <img src="imgs/avatar_ljp.png" alt="">
      </span>
      <span class="username">李建鹏</span>
    </div>
  </div>
  <div class="main" id="app">
    <div class="content">
      <div class="content_top">
        <div class="content_title"></div>
        <div class="content_handle">
          <!-- <a href="#" class="icon_edit">数据修改</a> -->
          <a href="javascript:;" class="file"> 导入数据
            <input type="file" class="uploadExcel" accept=".xls, .xlsx" id="importExcel"
              @change="submitCollectionFlowImport" />
          </a>
          <!-- <a href="#" class="icon_import">导入数据</a> -->
          <a href="#" class="icon_export">导出数据</a>
          <el-input placeholder="学校或班级名称" suffix-icon="el-icon-search" v-model="search">
          </el-input>
        </div>
      </div>
      <div class="table_content">
        <template v-if="id ==''">
          <!-- 所有合作院校数据 -->
          <el-table ref="multipleTable"
            :header-cell-style="{color: '#fff', fontSize: '12px', backgroundColor: '#3e85ff'}"
            :data="pageFilter.filter(data => !search || data.name.toLowerCase().includes(search.toLowerCase()))"
            @selection-change="handleSelectionChange" tooltip-effect="dark"
            style="width: 100%;padding: 10px;border: none;">
            <el-table-column type="selection" width="55">
            </el-table-column>
            <el-table-column label="序号" width="60">
              <template slot-scope="scope">{{ scope.row.id }}</template>
            </el-table-column>
            <el-table-column label="院校" width="120">
              <template slot-scope="scope">{{ scope.row.date }}</template>
            </el-table-column>
            <el-table-column label="班级" width="120">
              <template slot-scope="scope">{{ scope.row.date }}</template>
            </el-table-column>
            <el-table-column label="学历" width="120">
              <template slot-scope="scope">{{ scope.row.date }}</template>
            </el-table-column>
            <el-table-column prop="name" label="专业方向" width="120">
            </el-table-column>
            <el-table-column prop="address" label="学校数据" show-overflow-tooltip>
            </el-table-column>
            <el-table-column prop="address" label="学生总数" show-overflow-tooltip>
            </el-table-column>
            <el-table-column label="操作" width="100">
              <template slot-scope="scope">
                <el-button @click="handleClick(scope.row)" type="text" size="small">查看</el-button>
                <el-button type="text" size="small">编辑</el-button>
              </template>
            </el-table-column>
          </el-table>
        </template>
        <template v-else>
          <!-- 院校对应学生数据 -->
          <el-table ref="multipleTable"
            :header-cell-style="{color: '#fff', fontSize: '12px', backgroundColor: '#3e85ff'}"
            :data="pageFilter.filter(data => !search || data.name.toLowerCase().includes(search.toLowerCase()))"
            tooltip-effect="dark" style="width: 100%;padding: 10px;border: none;">
            <el-table-column type="selection" width="55">
            </el-table-column>
            <el-table-column label="序号" width="60">
              <template slot-scope="scope">{{ scope.row.id }}</template>
            </el-table-column>
            <el-table-column label="姓名" width="120">
              <template slot-scope="scope">{{ scope.row.name }}</template>
            </el-table-column>
            <el-table-column label="班级" width="120">
              <template slot-scope="scope">{{ scope.row.date }}</template>
            </el-table-column>
            <el-table-column label="学历" width="120">
              <template slot-scope="scope">{{ scope.row.date }}</template>
            </el-table-column>
            <el-table-column prop="name" label="专业方向" width="120">
            </el-table-column>
            <el-table-column prop="address" label="工作经历" show-overflow-tooltip>
            </el-table-column>
            <el-table-column prop="address" label="自我评价" show-overflow-tooltip>
            </el-table-column>
            <el-table-column width="100">
              <template slot="header" slot-scope="scope">
                <el-button icon="el-icon-back" round size="mini" @click="handleClickBack(scope.row)"></el-button>
              </template>
              <template slot-scope="scope">
                <el-button @click="handleClick(scope.row)" type="text" size="small">编辑</el-button>
              </template>
            </el-table-column>
          </el-table>
        </template>
        <el-pagination small layout="prev, pager, next" :page-size="pageSize" @prev-click="prevPage"
          @next-click="nextPage" @current-change="currentPageFunc" :current-page='currentPage'
          :total="tableData.length">
        </el-pagination>
      </div>
    </div>
  </div>


  <script src="https://cdn.bootcdn.net/ajax/libs/vue/2.6.9/vue.js"></script>
  <script src="js/element-ui.js"></script>
  <script>
    new Vue({
      el: '#app',
      data() {
        return {
          id: '',
          search: '', //搜索
          pageSize: 5,  //默认一页显示数据个数
          currentPage: 1,  //当前页码
          tableData: [{
            id: 1,
            date: '山东劳动',
            name: '王小虎',
            address: '上海市普陀区金沙江路 1518 弄'
          }, {
            id: 2,
            date: '山东商职',
            name: '山东商职',
            address: '上海市普陀区金沙江路 1518 弄'
          }, {
            id: 3,
            date: '山东商职',
            name: '王小虎',
            address: '上海市普陀区金沙江路 1518 弄'
          }, {
            id: 4,
            date: '山东商职',
            name: '王小虎',
            address: '上海市普陀区金沙江路 1518 弄'
          }, {
            id: 5,
            date: '山东劳动',
            name: '王小虎',
            address: '上海市普陀区金沙江路 1518 弄'
          }, {
            id: 6,
            date: '山东劳动',
            name: '王小虎',
            address: '上海市普陀区金沙江路 1518 弄'
          }, {
            id: 7,
            date: '山东劳动',
            name: '王小虎',
            address: '上海市普陀区金沙江路 1518 弄'
          }],
          multipleSelection: []   //选中数据
        }
      },
      computed: {
        //分页
        pageFilter() {
          //开始数据的下标
          let startVal = parseInt((this.currentPage - 1) * this.pageSize);
          return this.tableData.slice(startVal, startVal + this.pageSize);
          //1页 0  5  1-1 *5     (currentPage-1)*pageSize    (currentPage-1)*pageSize + pageSize
          //2页 5 10   2-1 *5
          //3页 10 15   3-1 *5
        }
      },
      methods: {
        handleSelectionChange(val) {
          console.log(val);
          this.multipleSelection = val;
        },
        //编辑
        handleClick(obj) {
          console.log(obj)
          this.id = obj.id;
        },
        handleClickBack() {
          this.id = "";
        },
        //分页切换，上一页
        prevPage(val) {
          this.currentPage = val
        },
        //下一页
        nextPage(val) {
          this.currentPage = val
        },
        //当前页
        currentPageFunc(val) {
          this.currentPage = val
        },
        //导入数据
        submitCollectionFlowImport: function (type) {
          var self = this;
          let fileFormData = new FormData();
          fileFormData.append("file", $("#importExcel")[0].files[0]);
          let requestConfig = {
            headers: {
              "Content-Type": "multipart/form-data",
            },
          };
          const instance = axios.create({
            withCredentials: true,
          });

          instance
            .post(
              url,
              fileFormData,
              requestConfig
            )
            .then((res) => {
              if (res.data.status == "ok") {
                alert('上传成功');
              }
            });
        }
      }
    })
  </script>
</body>

</html>